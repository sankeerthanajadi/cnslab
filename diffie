public class DiffieHellman {

    static long modPow(long base, long exp, long mod) {
        return (long) Math.pow(base, exp) % mod;
    }

    public static void main(String[] args) {

        long P = 23;  // Public prime
        long G = 9;   // Public base

        long a = 4;  // Alice's private key
        long A = modPow(G, a, P); // Alice's public key

        long b = 3;  // Bob's private key
        long B = modPow(G, b, P); // Bob's public key

        long aliceKey = modPow(B, a, P); // Shared key for Alice
        long bobKey   = modPow(A, b, P); // Shared key for Bob

        System.out.println("Shared key (Alice): " + aliceKey);
        System.out.println("Shared key (Bob):   " + bobKey);
    }
}
